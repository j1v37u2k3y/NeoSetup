---
# Common role for NeoSetup

- name: "ğŸ” Gather facts"
  ansible.builtin.setup:
    gather_subset:
      - min
      - distribution
      - env
      - date_time
  tags:
    - always

- name: "ğŸ“‹ Display system information"
  ansible.builtin.debug:
    msg: |
      ğŸ–¥ï¸  Platform: {{ ansible_facts.distribution }} {{ ansible_facts.distribution_version }}
      ğŸ—ï¸  Architecture: {{ ansible_facts.architecture }}
      ğŸ‘¤ User: {{ ansible_facts.user_id }}
      ğŸ  Home: {{ ansible_facts.env.HOME }}
      ğŸš Shell: {{ ansible_facts.env.SHELL | basename }}
      ğŸ¯ Operator: {{ neosetup_operator | default('unknown') }}

- name: "ğŸ  Ensure NeoSetup configuration directory exists"
  ansible.builtin.file:
    path: "{{ ansible_facts.env.HOME }}/.neosetup"
    state: directory
    mode: '0755'

- name: "ğŸ“ Create operator info file"
  ansible.builtin.copy:
    content: |
      # NeoSetup Configuration
      # Generated: {{ ansible_facts.date_time.iso8601 }}

      Operator: {{ neosetup_operator | default('unknown') }}
      Platform: {{ ansible_facts.distribution }} {{ ansible_facts.distribution_version }}
      Architecture: {{ ansible_facts.architecture }}
      User: {{ ansible_facts.user_id }}
      Home: {{ ansible_facts.env.HOME }}
    dest: "{{ ansible_facts.env.HOME }}/.neosetup/operator.info"
    mode: '0644'
